# –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –î–≤–∏–≥—É–Ω–∞ –°–∏–º—É–ª—è—Ü—ñ—ó (Simulation Engine)

–¶–µ–π –¥–æ–∫—É–º–µ–Ω—Ç –º—ñ—Å—Ç–∏—Ç—å —Ç–µ—Ö–Ω—ñ—á–Ω–∏–π –æ–ø–∏—Å –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ—ó –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ Entropia 3D, –º–µ—Ö–∞–Ω—ñ–∑–º—ñ–≤ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó —Ç–∞ –ø—Ä–∏–Ω—Ü–∏–ø—ñ–≤ –≤–∑–∞—î–º–æ–¥—ñ—ó –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤.

## üèõÔ∏è –û–≥–ª—è–¥ –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏

–°–∏—Å—Ç–µ–º–∞ –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞ –≥—ñ–±—Ä–∏–¥–Ω–æ–º—É –ø—ñ–¥—Ö–æ–¥—ñ, —â–æ –ø–æ—î–¥–Ω—É—î **ECS (Entity Component System)** –¥–ª—è –ª–æ–≥—ñ–∫–∏ –∞–≥–µ–Ω—Ç—ñ–≤ —Ç–∞ **SOA (Service-Oriented Architecture)** –¥–ª—è —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∏—Ö –∑–∞–¥–∞—á.

### –û—Å–Ω–æ–≤–Ω—ñ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –†–æ–ª—å —É —Å–∏—Å—Ç–µ–º—ñ | –¢–µ—Ö–Ω—ñ—á–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è |
|:---|:---|:---|
| `SimulationEngine` | –ì–æ–ª–æ–≤–Ω–∏–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä | –¶–∏–∫–ª –æ–Ω–æ–≤–ª–µ–Ω–Ω—è (Update Loop), –∫–µ—Ä—É–≤–∞–Ω–Ω—è –∂–∏—Ç—Ç—î–≤–∏–º —Ü–∏–∫–ª–æ–º —Å—É—Ç–Ω–æ—Å—Ç–µ–π |
| `StatisticsManager` | –ê–Ω–∞–ª—ñ—Ç–∏—á–Ω–µ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è | –ö–µ—à—É–≤–∞–Ω–Ω—è –º–µ—Ç—Ä–∏–∫, –∞–Ω–∞–ª—ñ–∑ –ø–æ–ø—É–ª—è—Ü—ñ—ó, —Å—Ç–∞–Ω –∫–∞–º–µ—Ä–∏ |
| `BufferManager` | –ö–µ—Ä—É–≤–∞–Ω–Ω—è –ø–∞–º'—è—Ç—Ç—é | –ê–¥–∞–ø—Ç–∏–≤–Ω–∞ –∞–ª–æ–∫–∞—Ü—ñ—è Float32Array –¥–ª—è Instanced Rendering |
| `SpatialHashGrid` | –ü—Ä–æ—Å—Ç–æ—Ä–æ–≤–∞ —ñ–Ω–¥–µ–∫—Å–∞—Ü—ñ—è | –•–µ—à—É–≤–∞–Ω–Ω—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –¥–ª—è O(1) –ø–æ—à—É–∫—É —Å—É—Å—ñ–¥—ñ–≤ |

---

## üèéÔ∏è –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ (Performance Engineering)

### 1. –ú—ñ–Ω—ñ–º—ñ–∑–∞—Ü—ñ—è —Ç–∏—Å–∫—É –Ω–∞ Garbage Collector (GC)
–£ –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö —à–ª—è—Ö–∞—Ö –æ–±—á–∏—Å–ª–µ–Ω—å (60 —Ä–∞–∑—ñ–≤ –Ω–∞ —Å–µ–∫—É–Ω–¥—É) –ø–æ–≤–Ω—ñ—Å—Ç—é –≤–∏–∫–ª—é—á–µ–Ω–æ –¥–∏–Ω–∞–º—ñ—á–Ω—É –∞–ª–æ–∫–∞—Ü—ñ—é –æ–±'—î–∫—Ç—ñ–≤.

#### üõ†Ô∏è –ú–µ—Ç–æ–¥–∏:
- **Object Pooling**: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `forceAccumulators` —É `BehaviorSystem` –¥–ª—è –Ω–∞–∫–æ–ø–∏—á–µ–Ω–Ω—è —Å–∏–ª –±–µ–∑ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö –≤–µ–∫—Ç–æ—Ä—ñ–≤.
- **Reusable Result Buffers**: `SpatialHashGrid` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ —Å—Ç–∞–ª—ñ –º–∞—Å–∏–≤–∏ –¥–ª—è –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –ø–æ—à—É–∫—É —Å—É—Å—ñ–¥—ñ–≤.
- **Metabolic Breakdown Caching**: `MetabolismSystem` –∑–∞–ø–æ–≤–Ω—é—î —ñ—Å–Ω—É—é—á–∏–π –æ–±'—î–∫—Ç –∑–∞–º—ñ—Å—Ç—å –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ.

```mermaid
graph LR
    System["System Update"] -->|Reuse| Pool["Object Pool / Cache"]
    Pool -->|Fill| Logic["Business Logic"]
    Logic -->|Result| System
    style System fill:#f9f,stroke:#333,stroke-width:2px
```

### 2. –ü—Ä–æ—Å—Ç–æ—Ä–æ–≤–∞ –î–µ–∫–æ–º–ø–æ–∑–∏—Ü—ñ—è
–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è **Spatial Hash Grid** –¥–æ–∑–≤–æ–ª—è—î –æ–±–º–µ–∂–∏—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ –∫–æ–ª—ñ–∑—ñ–π —Ç–∞ –≤–∑–∞—î–º–æ–¥—ñ–π –ª–∏—à–µ –Ω–∞–π–±–ª–∏–∂—á–∏–º–∏ —Å—É—Å—ñ–¥–∞–º–∏.
- **–°–µ—Ä–µ–¥–Ω—è —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å**: $O(1)$ –¥–ª—è –ø–æ—à—É–∫—É –≤ —Ä–∞–¥—ñ—É—Å—ñ.
- **–ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è**: –ï—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –Ω–µ –¥–µ–≥—Ä–∞–¥—É—î –ø—Ä–∏ –∑–±—ñ–ª—å—à–µ–Ω–Ω—ñ —Ä–æ–∑–º—ñ—Ä—É —Å–≤—ñ—Ç—É, –ª–∏—à–µ –ø—Ä–∏ –µ–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ñ–π —â—ñ–ª—å–Ω–æ—Å—Ç—ñ.

---

## üßµ –ë–∞–≥–∞—Ç–æ–ø–æ—Ç–æ–∫–æ–≤—ñ—Å—Ç—å (Web Workers)

–î–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —Å—Ç–∞–±—ñ–ª—å–Ω–æ–≥–æ UI-–ø–æ—Ç–æ–∫—É (React/Main Thread), —Å–∏–º—É–ª—è—Ü—ñ—è —ñ–∑–æ–ª—å–æ–≤–∞–Ω–∞ —É Web Worker. –¶–µ –¥–æ–∑–≤–æ–ª—è—î —Ä–æ–∑–¥—ñ–ª–∏—Ç–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤—ñ–¥–º–∞–ª—å–æ–≤—É–≤–∞–Ω–Ω—è —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É —Ç–∞ —ñ–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ñ –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è.

### –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏

![–°—Ö–µ–º–∞ –≤–∑–∞—î–º–æ–¥—ñ—ó –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ —á–µ—Ä–µ–∑ Web Worker](./assets/architecture_diagram.png)

### –ü—Ä–æ—Ç–æ–∫–æ–ª –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó

```mermaid
sequenceDiagram
    participant UI as "Main Thread (React)"
    participant Proxy as "EngineProxy"
    participant Worker as "Simulation Worker"
    participant Engine as "SimulationEngine"

    UI->>Proxy: init(scale)
    Proxy->>Worker: postMessage({type: 'init'})
    Worker->>Engine: new SimulationEngine()
    Engine-->>Worker: success
    Worker-->>Proxy: {type: 'initialized'}
    
    loop –ö–æ–∂–µ–Ω –∫–∞–¥—Ä (60 FPS)
        Proxy->>Worker: postMessage({type: 'update'})
        Worker->>Engine: update()
        Engine->>Engine: Physics, Behavior, Collision
        Engine->>Worker: getRenderData()
        Worker-->>Proxy: {type: 'updated', buffers: Float32Array} (Transferable)
        Proxy-->>UI: Update Viewport
    end
```

### –ê–Ω–∞–ª—ñ–∑ –ü—ñ–¥—Ö–æ–¥—É: –ü–µ—Ä–µ–≤–∞–≥–∏ —Ç–∞ –ù–µ–¥–æ–ª—ñ–∫–∏

–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Web Workers –¥–ª—è –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–æ–≥–æ —è–¥—Ä–∞ –Ω–∞–¥–∞—î –∑–Ω–∞—á–Ω—ñ –ø–µ—Ä–µ–≤–∞–≥–∏ –¥–ª—è –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–æ—Å—Ç—ñ, –ø—Ä–æ—Ç–µ –≤–Ω–æ—Å–∏—Ç—å –ø–µ–≤–Ω—ñ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è.

#### –ü–µ—Ä–µ–≤–∞–≥–∏ (Advantages):
1. **üöÄ UI Responsiveness (60 FPS UI)**: –ù–∞–≤—ñ—Ç—å –ø—Ä–∏ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ —Å–∏–º—É–ª—è—Ü—ñ—ó, —â–æ –ø–µ—Ä–µ–≤–∏—â—É—î –±—é–¥–∂–µ—Ç –∫–∞–¥—Ä—É (16.6 –º—Å), —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ç–∞ –∞–Ω—ñ–º–∞—Ü—ñ—ó –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –ø–ª–∞–≤–Ω–∏–º–∏, –æ—Å–∫—ñ–ª—å–∫–∏ –æ—Å–Ω–æ–≤–Ω–∏–π –ø–æ—Ç—ñ–∫ –Ω–µ –±–ª–æ–∫—É—î—Ç—å—Å—è.
2. **üíé –ü–∞—Ä–∞–ª–µ–ª—ñ–∑–∞—Ü—ñ—è**: –°—É—á–∞—Å–Ω—ñ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –æ–∫—Ä–µ–º–µ —è–¥—Ä–æ –¥–ª—è Worker, —â–æ —Ñ—ñ–∑–∏—á–Ω–æ –∑–±—ñ–ª—å—à—É—î –¥–æ—Å—Ç—É–ø–Ω—É –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω—É –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å.
3. **üõ°Ô∏è –Ü–∑–æ–ª—è—Ü—ñ—è –∑–±–æ—ó–≤**: –ü–æ–º–∏–ª–∫–∞ –≤ —Ü–∏–∫–ª—ñ —Å–∏–º—É–ª—è—Ü—ñ—ó –Ω–µ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ "–∑–∞–≤–∏—Å–∞–Ω–Ω—è" –≤—Å—ñ—î—ó –≤–∫–ª–∞–¥–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –∫–æ—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–æ–±–∏—Ç–∏ –≤–∏–Ω—è—Ç–∫–æ–≤—É —Å–∏—Ç—É–∞—Ü—ñ—é.
4. **üìâ Zero-copy Transfer**: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–∞–±–µ–ª—å–Ω–∏—Ö –æ–±'—î–∫—Ç—ñ–≤ (`Float32Array`) –Ω—ñ–≤–µ–ª—é—î –≤–∏—Ç—Ä–∞—Ç–∏ –Ω–∞ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –≤–µ–ª–∏–∫–∏—Ö –º–∞—Å–∏–≤—ñ–≤ –¥–∞–Ω–∏—Ö.

#### –ù–µ–¥–æ–ª—ñ–∫–∏ (Disadvantages):
1. **üõ∞Ô∏è –ó–∞—Ç—Ä–∏–º–∫–∞ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó (Latency)**: –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è `postMessage` –º–∞—é—Ç—å –º—ñ–∫—Ä–æ—Å–∫–æ–ø—ñ—á–Ω—É –∑–∞—Ç—Ä–∏–º–∫—É (serialize/deserialize overhead), —â–æ –º–æ–∂–µ –±—É—Ç–∏ –∫—Ä–∏—Ç–∏—á–Ω–∏–º –¥–ª—è VR-–¥–æ–¥–∞—Ç–∫—ñ–≤ –∞–±–æ high-speed action —Å–∏—Å—Ç–µ–º.
2. **üß© –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –ø—Ä–∏—Ä–æ–¥–∞ –≤–∑–∞—î–º–æ–¥—ñ—ó –≤–∏–º–∞–≥–∞—î —Å–∫–ª–∞–¥–Ω—ñ—à–æ—ó –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ (Proxy-–æ–±'—î–∫—Ç–∏, —Å–∏—Å—Ç–µ–º–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å) –∑–∞–º—ñ—Å—Ç—å –ø—Ä—è–º–æ–≥–æ –≤–∏–∫–ª–∏–∫—É –º–µ—Ç–æ–¥—ñ–≤.
3. **üêû –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è**: Debugging –±–∞–≥–∞—Ç–æ–ø–æ—Ç–æ–∫–æ–≤–∏—Ö —Å–∏—Å—Ç–µ–º —É—Å–∫–ª–∞–¥–Ω—é—î—Ç—å—Å—è —á–µ—Ä–µ–∑ –Ω–µ–ª—ñ–Ω—ñ–π–Ω—ñ—Å—Ç—å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ç–∞ –æ–±–º–µ–∂–µ–Ω—É –ø—ñ–¥—Ç—Ä–∏–º–∫—É –¥–µ—è–∫–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞ –¥–ª—è Worker context.

### üõ°Ô∏è –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –†—ñ—à–µ–Ω–Ω—è –¥–ª—è –ú—ñ–Ω—ñ–º—ñ–∑–∞—Ü—ñ—ó –ó–∞—Ç—Ä–∏–º–∫–∏

#### 1. SharedArrayBuffer (Zero-Latency Shared Memory) ‚úÖ
–ó–∞–º—ñ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á—ñ –¥–∞–Ω–∏—Ö —á–µ—Ä–µ–∑ `postMessage`, –æ–±–∏–¥–≤–∞ –ø–æ—Ç–æ–∫–∏ –ø—Ä–∞—Ü—é—é—Ç—å –∑ **—Å–ø—ñ–ª—å–Ω–æ—é –¥—ñ–ª—è–Ω–∫–æ—é –ø–∞–º'—è—Ç—ñ**.
- **–°—Ç–∞—Ç—É—Å**: –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–æ.
- **–Ø–∫ –ø—Ä–∞—Ü—é—î**: –°—Ç–≤–æ—Ä—é—î—Ç—å—Å—è `SharedArrayBuffer`, —è–∫–∏–π –º–∞–ø–∏—Ç—å—Å—è –Ω–∞ `TypedArray` –≤ –æ–±–æ—Ö –ø–æ—Ç–æ–∫–∞—Ö. –ó–º—ñ–Ω–∏, –≤–Ω–µ—Å–µ–Ω—ñ Worker-–æ–º, –º–∏—Ç—Ç—î–≤–æ –¥–æ—Å—Ç—É–ø–Ω—ñ –≤ Main Thread.
- **–Ü–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞**: –ù–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ `Cross-Origin-Opener-Policy: same-origin` —Ç–∞ `Cross-Origin-Embedder-Policy: require-corp` –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ shared memory.

#### 2. Client-Side Interpolation & Prediction (–Ü–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü—ñ—è —Ç–∞ –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è)
Main Thread –Ω–µ –ø—Ä–æ—Å—Ç–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –æ—Å—Ç–∞–Ω–Ω—ñ–π —Å—Ç–∞–Ω, –∞ "–ø–µ—Ä–µ–¥–±–∞—á–∞—î" —Ä—É—Ö –æ–±'—î–∫—Ç—ñ–≤ –º—ñ–∂ –ø–∞–∫–µ—Ç–∞–º–∏ –¥–∞–Ω–∏—Ö –≤—ñ–¥ Worker-–∞.
- **–Ø–∫ –ø—Ä–∞—Ü—é—î**: –Ø–∫—â–æ Worker –ø—Ä–∏—Å–∏–ª–∞—î –¥–∞–Ω—ñ 30 —Ä–∞–∑—ñ–≤ –Ω–∞ —Å–µ–∫—É–Ω–¥—É, –∞ UI –ø—Ä–∞—Ü—é—î –ø—Ä–∏ 60 FPS, Main Thread —ñ–Ω—Ç–µ—Ä–ø–æ–ª—é—î –ø–æ–∑–∏—Ü—ñ—é –æ–±'—î–∫—Ç–∞ –º—ñ–∂ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º —Ç–∞ –ø–æ—Ç–æ—á–Ω–∏–º –∫–∞–¥—Ä–∞–º–∏.
- **–ü–µ—Ä–µ–≤–∞–≥–∞**: –í—ñ–∑—É–∞–ª—å–Ω–∞ –ø–ª–∞–≤–Ω—ñ—Å—Ç—å 144+ FPS –Ω–∞–≤—ñ—Ç—å –ø—Ä–∏ –Ω–∏–∑—å–∫–æ–º—É Tick Rate —Å–∏–º—É–ª—è—Ü—ñ—ó. –ì—Ä–∞–≤–∫—É –∑–¥–∞—î—Ç—å—Å—è, —â–æ —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∞—Ü—é—î –º–∏—Ç—Ç—î–≤–æ.

#### 3. Adaptive Batching & Triple Buffering (–ü–æ—Ç—Ä—ñ–π–Ω–∞ –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü—ñ—è)
–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–µ–∫—ñ–ª—å–∫–æ—Ö –±—É—Ñ–µ—Ä—ñ–≤ –¥–ª—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ–≥–æ —á–∏—Ç–∞–Ω–Ω—è —Ç–∞ –∑–∞–ø–∏—Å—É.
- **–Ø–∫ –ø—Ä–∞—Ü—é—î**: –ü–æ–∫–∏ GPU —á–∏—Ç–∞—î `Buffer A`, Worker –∑–∞–ø–∏—Å—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∫—Ä–æ–∫—É –≤ `Buffer B`, –∞ `Buffer C` –≥–æ—Ç—É—î—Ç—å—Å—è –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Ü–∏–∫–ª—É.
- **–ü–µ—Ä–µ–≤–∞–≥–∞**: –£—Å—É–≤–∞—î "—Ç—Ä–µ–º—Ç—ñ–Ω–Ω—è" (jitter) —Ç–∞ "–ø–∞—É–∑–∏", –∫–æ–ª–∏ Main Thread —á–µ–∫–∞—î –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –æ–±—á–∏—Å–ª–µ–Ω—å Worker-–∞. –¶–µ –¥–æ–∑–≤–æ–ª—è—î —Å–∏–º—É–ª—è—Ü—ñ—ó –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –≤–∏–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è–º –≥—Ä–∞—Ñ—ñ–∫–∏.

### –ü–µ—Ä–µ–¥–∞—á–∞ –î–∞–Ω–∏—Ö (Transferable Objects)
–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `Float32Array` –±–∞—Ñ–µ—Ä—ñ–≤ –¥–æ–∑–≤–æ–ª—è—î –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ –≤–µ–ª–∏–∫—ñ –º–∞—Å–∏–≤–∏ –¥–∞–Ω–∏—Ö –ø—Ä–æ –ø–æ–ª–æ–∂–µ–Ω–Ω—è –∞–≥–µ–Ω—Ç—ñ–≤ –º—ñ–∂ –ø–æ—Ç–æ–∫–∞–º–∏ –±–µ–∑ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è (zero-copy), —â–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö —Ç–∞ —Å–ª–∞–±–∫–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.

---

## üß¨ –ì–µ–Ω–µ—Ç–∏—á–Ω–∞ –ú–æ–¥–µ–ª—å

–ö–æ–∂–µ–Ω –∞–≥–µ–Ω—Ç –≤–æ–ª–æ–¥—ñ—î –≥–µ–Ω–æ–º–æ–º, —â–æ –∫–æ–¥—É—î—Ç—å—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é `Genome`. 
- **–ú—É—Ç–∞–≥–µ–Ω–µ–∑**: –ü—Ä–∏ —Ä–µ–ø—Ä–æ–¥—É–∫—Ü—ñ—ó –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ (—à–≤–∏–¥–∫—ñ—Å—Ç—å, –º–µ—Ç–∞–±–æ–ª—ñ–∑–º, –∫–æ–ª—ñ—Ä) –∑–º—ñ–Ω—é—é—Ç—å—Å—è –Ω–∞ –≤–∏–ø–∞–¥–∫–æ–≤–∏–π –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –º—É—Ç–∞—Ü—ñ—ó.
- **–ü—Ä–∏—Ä–æ–¥–Ω–∏–π –≤—ñ–¥–±—ñ—Ä**: –ê–≥–µ–Ω—Ç–∏ –∑ –Ω–µ–µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—é –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—î—é —à–≤–∏–¥—à–µ –≤—Ç—Ä–∞—á–∞—é—Ç—å –µ–Ω–µ—Ä–≥—ñ—é (–µ–Ω—Ç—Ä–æ–ø—ñ—è) —Ç–∞ –≥–∏–Ω—É—Ç—å –¥–æ –º–æ–º–µ–Ω—Ç—É —Ä–µ–ø—Ä–æ–¥—É–∫—Ü—ñ—ó.

---

## üìä –§–æ—Ä–º–∞—Ç –î–∞–Ω–∏—Ö –†–µ–Ω–¥–µ—Ä–∏–Ω–≥—É (Render Buffers)

–î–∞–Ω—ñ –ø–µ—Ä–µ–¥–∞—é—Ç—å—Å—è –ø–ª–æ—Å–∫–∏–º–∏ –º–∞—Å–∏–≤–∞–º–∏ –¥–ª—è GPU Instancing:

| –ù–∞–±—ñ—Ä | Stride | –î–∞–Ω—ñ (per instance) |
|:---|:---:|:---|
| **Prey / Predator** | 13 | `x, y, z, vx, vy, vz, radius, rot, id, reserved[4]` |
| **Food** | 4 | `x, y, z, scale` |

---

## ‚ú® –í–∏—Å–Ω–æ–≤–æ–∫
–ü–æ—Ç–æ—á–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ Entropia 3D —Ñ–æ–∫—É—Å—É—î—Ç—å—Å—è –Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–º—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ —Ä–µ—Å—É—Ä—Å—ñ–≤ CPU —Ç–∞ –ø–∞–º'—è—Ç—ñ, —â–æ –¥–æ–∑–≤–æ–ª—è—î —Å–∏–º—É–ª—é–≤–∞—Ç–∏ —Ç–∏—Å—è—á—ñ –Ω–µ–∑–∞–ª–µ–∂–Ω–∏—Ö –∞–≥–µ–Ω—Ç—ñ–≤ —É –±—Ä–∞—É–∑–µ—Ä—ñ –±–µ–∑ –≤—Ç—Ä–∞—Ç–∏ –ø–ª–∞–≤–Ω–æ—Å—Ç—ñ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É.
