# Entropia 3D: –ï–≤–æ–ª—é—Ü—ñ–π–Ω–∞ –ü—ñ—Å–æ—á–Ω–∏—Ü—è

[![Build](https://img.shields.io/github/actions/workflow/status/dogmator/entropia/ci.yml?branch=main&label=build)](https://github.com/dogmator/entropia/actions)
[![TypeScript](https://img.shields.io/badge/TypeScript-strict-blue)](https://www.typescriptlang.org/)

**Entropia 3D** ‚Äî —Ü–µ –≤–∏—Å–æ–∫–æ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–∞ —Ç—Ä–∏–≤–∏–º—ñ—Ä–Ω–∞ —Å–∏–º—É–ª—è—Ü—ñ—è –µ–≤–æ–ª—é—Ü—ñ–π–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤, —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∞–≥–µ–Ω—Ç–Ω–æ–≥–æ –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è. –ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î —Å–∫–ª–∞–¥–Ω—É –¥–∏–Ω–∞–º—ñ–∫—É –±—ñ–æ–ª–æ–≥—ñ—á–Ω–∏—Ö —Å–∏—Å—Ç–µ–º, –¥–µ —Ü–∏—Ñ—Ä–æ–≤—ñ –æ—Ä–≥–∞–Ω—ñ–∑–º–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç—å –ø—Ä–∏—Ä–æ–¥–Ω–∏–π –≤—ñ–¥–±—ñ—Ä —É –¥–µ—Ç–µ—Ä–º—ñ–Ω–æ–≤–∞–Ω–æ–º—É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ.

## üöÄ [–ó–∞–ø—É—Å—Ç–∏—Ç–∏ Live Demo](https://dogmator.github.io/entropia/)

---

## üß¨ –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–∞ –ö–æ–Ω—Ü–µ–ø—Ü—ñ—è

–°–∏–º—É–ª—è—Ü—ñ—è –ø–æ–±—É–¥–æ–≤–∞–Ω–∞ –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö **Data-Oriented Design** —Ç–∞ **Service-Oriented Architecture (SOA)** –¥–ª—è –º—ñ–Ω—ñ–º—ñ–∑–∞—Ü—ñ—ó –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ Garbage Collector —Ç–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—ó –ø—Ä–æ–ø—É—Å–∫–Ω–æ—ó –∑–¥–∞—Ç–Ω–æ—Å—Ç—ñ –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–æ–≥–æ —è–¥—Ä–∞.

### üèõÔ∏è –û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—è –°–∏—Å—Ç–µ–º–∏

```mermaid
graph TD
    UI[React Interface] <--> Proxy[EngineProxy]
    Proxy <--> |Message Protocol| Worker[Web Worker]
    subgraph "Simulation Core (Worker Thread)"
        Worker <--> Engine[SimulationEngine]
        Engine --> Physics[PhysicsSystem]
        Engine --> Behavior[BehaviorSystem]
        Engine --> Metabolism[MetabolismSystem]
        Engine --> Collision[CollisionSystem]
        Engine --> Stats[StatisticsManager]
        Engine --> Buffers[BufferManager]
        Stats --> Grid[SpatialHashGrid]
        Collision --> Grid
    end
```

### üß¨ –ö–æ–Ω—Ü–µ–ø—Ü—ñ—è –ï–Ω—Ç—Ä–æ–ø—ñ—ó
–í —Ä–∞–º–∫–∞—Ö –¥–∞–Ω–æ—ó –º–æ–¥–µ–ª—ñ –µ–Ω—Ç—Ä–æ–ø—ñ—è –≤–∏—Å—Ç—É–ø–∞—î —è–∫ **–µ–Ω–µ—Ägety—á–Ω–∏–π –ø–æ–¥–∞—Ç–æ–∫ –Ω–∞ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è**:
- **üìä –ú–µ—Ç–∞–±–æ–ª—ñ—á–Ω–∏–π –±–∞–∑–∏—Å**: –ü–æ—Å—Ç—ñ–π–Ω–∞ –¥–µ–≥—Ä–∞–¥–∞—Ü—ñ—è –µ–Ω–µ—Ä–≥—ñ—ó –∑ —á–∞—Å–æ–º.
- **üèÉ –î–∏–Ω–∞–º—ñ—á–Ω—ñ –≤–∏—Ç—Ä–∞—Ç–∏**: –ï–∫—Å–ø–æ–Ω–µ–Ω—Ü—ñ–π–Ω–µ –∑—Ä–æ—Å—Ç–∞–Ω–Ω—è –µ–Ω–µ—Ä–≥–æ–≤–∏—Ç—Ä–∞—Ç –ø—Ä–∏ —ñ–Ω—Ç–µ–Ω—Å–∏–≤–Ω–∏—Ö –¥—ñ—è—Ö (—Ä—É—Ö, –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è).
- **üì° –°–µ–Ω—Å–æ—Ä–Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è**: –í–∞—Ä—Ç—ñ—Å—Ç—å –æ–±—Ä–æ–±–∫–∏ –ø—Ä–æ—Å—Ç–æ—Ä–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó (—Ä–∞–¥—ñ—É—Å —Å–ø—Ä–∏–π–Ω—è—Ç—Ç—è).

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω–∏–π –°—Ç–µ–∫ —Ç–∞ –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

| –°–µ–≥–º–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—è / –ú–µ—Ç–æ–¥ | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è |
|:---|:---|:---|
| **–Ø–¥—Ä–æ** | TypeScript 5 (Strict) | –î–µ—Ç–µ—Ä–º—ñ–Ω–æ–≤–∞–Ω–∞ –ª–æ–≥—ñ–∫–∞ —Ç–∞ —Ç–∏–ø—ñ–∑–∞—Ü—ñ—è |
| **–ì—Ä–∞—Ñ—ñ–∫–∞** | Three.js (WebGL 2) | –í–∏—Å–æ–∫–æ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–∏–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ |
| **Threading** | Web Workers | –Ü–∑–æ–ª—è—Ü—ñ—è –æ–±—á–∏—Å–ª–µ–Ω—å –≤—ñ–¥ UI-–ø–æ—Ç–æ–∫—É |
| **Memory** | TypedArrays (Float32) | Zero-copy –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–∏—Ö (Transferables) |
| **Grid** | Spatial Hash Grid | –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ—Å—Ç–æ—Ä–æ–≤–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ O(1) avg |

### ‚ö° –ö–ª—é—á–æ–≤—ñ –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó (Phase 1-4)
1. **Object Pooling**: –†–µ—é–∑–∏–Ω–≥ –≤–µ–∫—Ç–æ—Ä—ñ–≤ —Ç–∞ –æ–±'—î–∫—Ç—ñ–≤ —Å—Ç–∞–Ω—ñ–≤ –¥–ª—è —É–Ω–∏–∫–Ω–µ–Ω–Ω—è –∞–ª–æ–∫–∞—Ü—ñ–π —É –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö —Ü–∏–∫–ª–∞—Ö.
2. **Buffer Management**: –ê–¥–∞–ø—Ç–∏–≤–Ω–µ –∫–µ—Ä—É–≤–∞–Ω–Ω—è –ø–∞–º'—è—Ç—Ç—é –¥–ª—è Instanced Rendering.
3. **Engine Decomposition**: –í–∏–æ–∫—Ä–µ–º–ª–µ–Ω–Ω—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (`StatisticsManager`) —Ç–∞ –∫–µ—Ä—É–≤–∞–Ω–Ω—è –±—É—Ñ–µ—Ä–∞–º–∏ (`BufferManager`) —É –Ω–µ–∑–∞–ª–µ–∂–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏.
4. **Web Worker Migration**: –ü–æ–≤–Ω–∞ —ñ–∑–æ–ª—è—Ü—ñ—è —Å–∏–º—É–ª—è—Ü—ñ—ó –≤ –æ–∫—Ä–µ–º–æ–º—É —Ñ–æ–Ω–æ–≤–æ–º—É –ø–æ—Ç–æ—Ü—ñ.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ü—Ä–æ–µ–∫—Ç—É

```text
src/
‚îú‚îÄ‚îÄ core/                    # –ë–∞–∑–æ–≤–∞ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (EventBus, PerformanceMonitor)
‚îú‚îÄ‚îÄ simulation/              # –Ø–¥—Ä–æ —Å–∏–º—É–ª—è—Ü—ñ—ó
‚îÇ   ‚îú‚îÄ‚îÄ services/            # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –ë—É—Ñ–µ—Ä–∏, –°–ø–∞–≤–Ω (SOA)
‚îÇ   ‚îú‚îÄ‚îÄ systems/             # –§—ñ–∑–∏–∫–∞, –ü–æ–≤–µ–¥—ñ–Ω–∫–∞, –ú–µ—Ç–∞–±–æ–ª—ñ–∑–º (ECS)
‚îÇ   ‚îú‚îÄ‚îÄ Engine.ts            # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Å–∏–º—É–ª—è—Ü—ñ—ó
‚îÇ   ‚îî‚îÄ‚îÄ EngineProxy.ts       # Main-thread —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–æ Worker
‚îú‚îÄ‚îÄ shared/                  # Branded Types —Ç–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∏
‚îî‚îÄ‚îÄ ui/                      # React/Three.js –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è
```

---

## üì¶ –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è

### –õ–æ–∫–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ
```bash
pnpm install
pnpm run dev      # –ó–∞–ø—É—Å–∫ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ —Ä–æ–∑—Ä–æ–±–∫–∏
pnpm run test     # –ó–∞–ø—É—Å–∫ Unit-—Ç–µ—Å—Ç—ñ–≤
pnpm run check    # –ü–æ–≤–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ (types + lint)
```

### –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü—ñ—è (Docker)
```bash
docker compose up -d
```
–î–æ–¥–∞—Ç–æ–∫ –¥–æ—Å—Ç—É–ø–Ω–∏–π –∑–∞ –∞–¥—Ä–µ—Å–æ—é: `http://localhost:3000/entropia/`

---

## üîÆ Roadmap –†–æ–∑–≤–∏—Ç–∫—É

- [x] **Phase 1-3**: –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø–∞–º'—è—Ç—ñ —Ç–∞ –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü—ñ—è —è–¥—Ä–∞.
- [x] **Phase 4**: –Ü–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Web Workers (Transferable Buffers).
- [/] **Phase 4.1**: –ü–æ–≤–Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è UI –∑ Worker Proxy.
- [/] **Phase 5**: UI Optimization & Diagnostics Refactoring.

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è —Ç–∞ –ê–Ω–∞–ª—ñ–∑

- [–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –î–≤–∏–≥—É–Ω–∞](./docs/ARCHITECTURE.md) ‚Äî –î–µ—Ç–∞–ª—å–Ω–∏–π —Ç–µ—Ö–Ω—ñ—á–Ω–∏–π –æ–ø–∏—Å —Ç–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∏ —Ä–æ–±–æ—Ç–∏.
- [–í—ñ–¥–¥–∞–ª–µ–Ω–µ –õ–æ–≥—É–≤–∞–Ω–Ω—è](./docs/REMOTE_LOGGING.md) ‚Äî –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.
- [–û—Ü—ñ–Ω–∫–∞ —Ä–æ–±–æ—Ç–∏ Worker](./docs/WORKER_EVALUATION.md) ‚Äî –ê–Ω–∞–ª—ñ–∑ –∫–æ—Ä–µ–∫—Ç–Ω–æ—Å—Ç—ñ —Ç–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Ñ–æ–Ω–æ–≤–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å.
- [–ü–ª–∞–Ω –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É](./docs/REFACTORING_PLAN.md) ‚Äî –î–µ—Ç–∞–ª—å–Ω–∏–π –ø–ª–∞–Ω –º–æ–¥–µ—Ä–Ω—ñ–∑–∞—Ü—ñ—ó –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏.
- [–ú–µ—Ç—Ä–∏–∫–∏ —è–∫–æ—Å—Ç—ñ –ø—Ä–æ–µ–∫—Ç—É](./docs/QUALITY_METRICS.md) ‚Äî –ö–ª—é—á–æ–≤—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ —Å—Ç–∞–±—ñ–ª—å–Ω–æ—Å—Ç—ñ –∫–æ–¥—É.
- [–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ–π–Ω–∏–π –ø–ª–∞–Ω](docs/OPTIMIZATION_PLAN.md)
- [–ü—Ä–∏–Ω—Ü–∏–ø–∏ –ø—Ä–æ–µ–∫—Ç—É –¥–ª—è –∞–≥–µ–Ω—Ç—ñ–≤](AGENTS.md)
